\documentclass[12pt,a4paper]{report}

\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{a4,cite,amsmath,amssymb,amsthm}
\usepackage[T2A]{fontenc}
\usepackage{amstext}
\usepackage{latexsym}
\usepackage{euscript}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage{geometry}
\geometry{left=3cm}
\geometry{right=2cm}
\geometry{top=1.5cm}
\geometry{bottom=2cm}


\begin{document}

В рамках работ по практике было поставлено задание исследовать задачу построения графика горячей прокатки, сбалансированного по видам продукции.

Целью работы была разработка алгоритма решения этой задачи. Для достижения цели осуществлена формализация этой задачи в виде задачи математического программирования для последующего решения при помощи готовых библиотек.

Для начала опишем кратко основные понятия связанные с задачей построения графика горячей прокатки, сбалансированного по видам продукции.

Горячая прокатка это процесс, во время которого стальные заготовки в форме параллелепипедов, называемые слябами, проходят через валки стана горячей прокатки и прокатываются в длинные полосы металла. Одинаковые по геометрическим размерам и химическому составу слябы объединяют вместе в так называемые партии прокатки. Все слябы в рамках одной партии прокатки считаются идентичными. Во время прокатки слябы каждой партии следуют друг за другом непрерывно, не перемежаясь слябами из других партий, то есть партии прокатываются целиком и не дробятся на части.
Для каждой партии прокатки заданы целевые значения ширины и толщины, которые должны получить прокатываемые из этой партии полосы на выходе из стана. Также для каждой партии прокатки известна суммарная длина прокатываемых из нее полос и вид продукции, к которому относится данная партия.

Можно выделить два рабочих цикла стана горячей прокатки. Первый, или большой цикл, заключен между двумя последовательными заменами опорных валков стана. Замена делается обычно один раз в несколько дней. Второй, или малый цикл, заключен между двумя последовательными заменами рабочих валков стана. Длительность цикла работы стана между двумя последовательными заменами рабочих валков составляет несколько часов.
Задача оперативного планирования работы стана состоит в формировании последовательности партий, которая будет прокатана на стане в период между двумя очередными заменами рабочих валков. Такую последовательность партий называют графиком прокатки. Обычно в сутки требуется сформировать примерно четыре-шесть последовательных графиков прокатки.

График прокатки представляет собой упорядоченную последовательность партий, которая должна соответствовать технологическим ограничениям на допустимый порядок следования партий друг за другом через стан горячей прокатки. Эти технологические ограничения связаны с конструктивными особенностями прокатного стана и определяются геометрическими размерами партий. Были рассмотрены два основных ограничения. Первое ограничение заключается в том, что ширина каждой следующей партии в графике прокатки должна быть не больше ширины предыдущей, при этом запрещается, чтобы ширина следующей партии уменьшалась больше, чем на заданную величину. Второе ограничение заключается в том, что толщина каждой следующей партии не должна сильно отличаться от толщины предыдущей партии.

Для формализации этих ограничений введены функции $w$, $t$ и $l$, задающие целевую ширину, толщину партии  и суммарную длину прокатываемых из нее полос соответственно.

Ограничение на предшествование партий определим следующим образом: партия $q$ может непосредственно следовать за партией $p$ в графике прокатки в том и только в том случае, когда выполнено
\begin{enumerate}
\item ограничение <<для перехода по толщине>>:
 $|t_p - t_q| \le \min\{r(t_p), r(t_q)\}$;
\item ограничение <<для перехода по ширине>>:
$0 \le w_p - w_q \le \delta$.
\end{enumerate}

Определенное таким образом ограничение представляет собой формализацию базовых условий предшествования партий, используемых на некоторых отечественных предприятиях. В частности, на Магнитогорском металлургическом комбинате используется значение $\delta = 250 \; mm$. Далее  представлен пример функции $r$.
 \begin{equation*} r(t) = \begin{cases}
                0.8, & \text{если $t \in [1.29, 2]$;}\\
                1.5, & \text{если $t \in (2, 3]$;}\\
                2, & \text{если $t \in (3, 16]$};\\
                4, & \text{если $t \in (16, 20]$};\\
                \text{не определена}, & \text{если $t \in [0, 1.29) \cup (20, +\infty)$}.
         \end{cases} \end{equation*}


Помимо технологических ограничений в рассматриваемой задаче график прокатки должен удовлетворять еще и объемным ограничениям, которые заключаются в том, чтобы суммарную длина полос партий в последовательности, находилась в заданном диапазоне, а также суммарная длина полос по каждому виду продукции находилась в заданном диапазоне. График прокатки, удовлетворяющий объемным ограничениям, называется сбалансированным по видам продукции.

Практическая задача построения графика прокатки заключается в том, чтобы из заданного набора партий выбрать необходимое количество партий, чтобы удовлетворить объемные ограничения, и упорядочить их в соответствии с основными технологическими ограничениями.

Далее опишем основные результаты.

Практическая задача была формализована с использованием языка ориентированных графов. На множестве партий был построен ориентированный вершинно-взвешенный раскрашенный граф предшествования партий $G$.

\begin{figure}[h!]
\centering
\includegraphics[width=300px]{../img/colored_graph.png}
\caption{Граф предшествования партий $G$}
\label{precedence_graph}
\end{figure}

Весом каждой вершины в графе $G$ является вес соответствующей партии, цвет каждой вершины соответствует виду продукции. Две вершины $p$ и $q$ этого графа соединены ориентированным ребром $pq$ тогда и только тогда, когда партия $q$ может непосредственно следовать за партией $p$ в графике прокатки. Любому технологически допустимому графику прокатки соответствует простая цепь в графе предшествования партий $G$.Таким образом, задача построения сбалансированного графика прокатки была сведена к задачи поиска сбалансированной простой цепи в графе предшествования партий $G$. Обозначим множество всех простых цепей графа $G$ через $\mathbb{B}(G)$.

Пусть $P(M)$ — множество вершин произвольного подграфа $М$ графа $G$.

Для простой цепи $H \in \mathbb{B}(G)$ через $l(H)$ обозначим её вес.

$$l(H) \triangleq \displaystyle\sum_{p \in P(H)} l(p)$$

Пронумеруем виды продукции, пусть $F = \{f_1, f_2, \ldots, f_s\}$. Пусть $\mu_k$ это целевое значение суммарного веса партий $k$-го вида продукции в графике прокатки, $\Delta$ абсолютная величина допустимого отклонения от соответствующего целевого значения. Пусть  $L_{min}, L_{max}$ это числа, задающие диапазон допустимых значений суммарного веса всех партий в графике прокатки.

Сформулируем задачу поиска допустимого решения — найти в $\mathbb{B}(G)$ такую \\ цепь $H$, что выполнены ограничения:

\begin{equation}  L_{min} \le \displaystyle\sum_{p \in P(H)} l(p) \le L_{max} \end{equation}

\begin{equation}
\forall k \in \overline{1,s}\;\;\;\; \mu_k - \Delta_k \le \sum_{p \in P(H), f(p) = f_k} l(p) \le \mu_k + \Delta_k
\end{equation}



Задача поиска сбалансированной простой цепи была формализована в виде задачи целочисленного программирования. Формализация опирается на исследование структуры графа предшествования партий $G$. Это позволяет получить более компактную по числу неравенств задачу математического программирования, чем при использовании классических техник (например, для решения задачи коммивояжера). Также было предложено несколько упрощенных и приближенных вариантов формализации задачи поиска сбалансированной простой цепи, которые позволяют в некоторых случаях получить решение за более короткий промежуток времени. Было показано, что предложенная формализация задачи поиска сбалансированной простой цепи является корректной, то есть по решению задачи математического программирования можно построить решение задачи поиска сбалансированной простой цепи. Отметим тот факт, что если полученная задача математического программирования является несовместной, то исходная задача поиска сбалансированной простой цепи не имеет решение. Таким образом, предложенный подход позволяет за приемлемое с практической точки зрения время найти решение задачи поиска сбалансированной простой цепи, либо установить, что его нет.

Проведена серия численных экспериментов с использованием реальных данных полученных из базы ОАО <<ММК>>. Произведены расчеты более чем на $500$ наборах исходных данных, каждый из которых включает порядка $200$-$300$ партий прокатки. При программной реализации алгоритма решения задачи поиска сбалансированной простой цепи был использован язык программирования Java, решение задач математического программирования осуществлялось с использованием системы IBM ILOG CPLEX. Вычисления осуществлялись на персональном компьютере, среднее время на обработку одного набора данных составило около 30 секунд. В целом эксперименты показали пригодность разработанного подхода для решения практикой задачи построения сбалансированного графика прокатки.
\end{document} 